temp_data_4<-read.table('protokoly_2020.csv', sep=',', header=TRUE)
library(stringi)
daty<-character(nrow(temp_data_4))
daty2<-numeric(nrow(temp_data_4))
for (i in 1:nrow(temp_data_4)){
daty[i]<-stri_paste(stri_extract_all_regex(temp_data_4$date[i], '[0-9]+')[[1]][1],
stri_extract_all_regex(temp_data_4$date[i], '[0-9]+')[[1]][2], '2020', sep='.')
#print(strptime(daty[i], '%d.%m.%Y'))
daty2[i]<-as.Date(strptime(daty[i], '%d.%m.%Y'))
}
daty2<-as.Date(daty2, origin='1970-01-01')
temp_data_4$date<-daty2
temp_data_4<-limits_separation(temp_data_4)
temp_data_4<-limits_separation_2(temp_data_4)
temp_data<-split(temp_data_4, temp_data_4$colony)
temp_data<-lapply(temp_data, function(x){
data.frame(colony=x$colony[1],aggression=any(x$aggression_num!=0), territory=x$territory[1], num_upper=(max(na.omit(x$aggression_num_upper))),num_lower=(min(na.omit(x$aggression_num_lower))))
})
temp_data<-do.call(rbind,temp_data)
temp_data_2<-split(new_data, new_data$colony)
temp_data_2<-lapply(temp_data_2, function(x){
data.frame(colony=x$colony[1],headwidth=mean(x$head_width),n=nrow(x))
})
temp_data_2<-do.call(rbind,temp_data_2)
new_data_2<-merge(temp_data, temp_data_2, by='colony', all.x=TRUE)
results_2020<-new_data_2
temp_data_3<-split(temp_data_4, temp_data_4$colony)
temp_data_3<-lapply(temp_data_3, function(x){
x<-x[order(x$date),]
y<-x[1,c('colony','treatment')]
y
})
temp_data_3<-do.call(rbind,temp_data_3)
colnames(temp_data_3)[2]<-'first_treatment'
library(dplyr)
temp_data<-group_by(temp_data_4, colony, treatment)
temp_data<-summarize(temp_data, aggression=any(aggression_num!=0))
temp_data<-ungroup(temp_data)
temp_data<-as.data.frame(temp_data)
temp_data<-split(temp_data,temp_data$treatment)
colnames(temp_data[[1]])[3]<-'treatment 1'
colnames(temp_data[[2]])[3]<-'treatment 20'
results_2020<-merge(results_2020, temp_data[[1]][,c(1,3)], by='colony', all.x=TRUE)
results_2020<-merge(results_2020, temp_data[[2]][,c(1,3)], by='colony',all.x=TRUE)
results_2020<-results_2020[,-2]
results_2020<-merge(results_2020, temp_data_3, by='colony', all.x=TRUE)
results_2020<-results_2020[order(results_2020$territory),]
summarised_results<-rbind(results_2019,results_2020)
temp_data_4<-read.table('D:\\Badania\\Agresywność mrówek F. fusca na i poza terytorium F. polyctena\\Analiza danychprotokoly_2020.csv', sep=',', header=TRUE)
temp_data_4<-read.table('D:\\Badania\\Agresywność mrówek F. fusca na i poza terytorium F. polyctena\\Analiza danych\\protokoly_2020.csv', sep=',', header=TRUE)
library(stringi)
daty<-character(nrow(temp_data_4))
daty2<-numeric(nrow(temp_data_4))
for (i in 1:nrow(temp_data_4)){
daty[i]<-stri_paste(stri_extract_all_regex(temp_data_4$date[i], '[0-9]+')[[1]][1],
stri_extract_all_regex(temp_data_4$date[i], '[0-9]+')[[1]][2], '2020', sep='.')
#print(strptime(daty[i], '%d.%m.%Y'))
daty2[i]<-as.Date(strptime(daty[i], '%d.%m.%Y'))
}
daty2<-as.Date(daty2, origin='1970-01-01')
temp_data_4$date<-daty2
temp_data_4<-limits_separation(temp_data_4)
temp_data_4<-limits_separation_2(temp_data_4)
temp_data<-split(temp_data_4, temp_data_4$colony)
temp_data<-lapply(temp_data, function(x){
data.frame(colony=x$colony[1],aggression=any(x$aggression_num!=0), territory=x$territory[1], num_upper=(max(na.omit(x$aggression_num_upper))),num_lower=(min(na.omit(x$aggression_num_lower))))
})
temp_data<-do.call(rbind,temp_data)
temp_data_2<-split(new_data, new_data$colony)
temp_data_2<-lapply(temp_data_2, function(x){
data.frame(colony=x$colony[1],headwidth=mean(x$head_width),n=nrow(x))
})
temp_data_2<-do.call(rbind,temp_data_2)
new_data_2<-merge(temp_data, temp_data_2, by='colony', all.x=TRUE)
results_2020<-new_data_2
temp_data_3<-split(temp_data_4, temp_data_4$colony)
temp_data_3<-lapply(temp_data_3, function(x){
x<-x[order(x$date),]
y<-x[1,c('colony','treatment')]
y
})
temp_data_3<-do.call(rbind,temp_data_3)
colnames(temp_data_3)[2]<-'first_treatment'
library(dplyr)
temp_data<-group_by(temp_data_4, colony, treatment)
temp_data<-summarize(temp_data, aggression=any(aggression_num!=0))
temp_data<-ungroup(temp_data)
temp_data<-as.data.frame(temp_data)
temp_data<-split(temp_data,temp_data$treatment)
colnames(temp_data[[1]])[3]<-'treatment 1'
colnames(temp_data[[2]])[3]<-'treatment 20'
results_2020<-merge(results_2020, temp_data[[1]][,c(1,3)], by='colony', all.x=TRUE)
results_2020<-merge(results_2020, temp_data[[2]][,c(1,3)], by='colony',all.x=TRUE)
results_2020<-results_2020[,-2]
results_2020<-merge(results_2020, temp_data_3, by='colony', all.x=TRUE)
results_2020<-results_2020[order(results_2020$territory),]
summarised_results<-rbind(results_2019,results_2020)
devtoolas::load_all()
devtools::load_all()
data("aggression_probing_tests")
colnames(aggression_probing_tests)
unique(aggression_probing_tests$treatment)
aggression_probing_tests
chi_sq_test(treatment_ = "sanguinea_20", data = aggression_probing_tests)
devtools::load_all()
chi_sq_test(treatment_ = "sanguinea_20", data = aggression_probing_tests)
chi_sq_test(treatment_ = "sanguinea_1", data = aggression_probing_test)
data("agitation_tests")
colnames(agitation_tests)
head(agitation_tests)
unique(agigation_tests$treatment)
unique(agitation_tests$treatment)
temp <- agitation_tests$treatment
temp <- as.factor(temp)
levels(temp)
head(agitation_tests)
head(agitation_tests, n = 50)
levels(temp)
levels(temp)[1]
levels(temp)[1]<- NA
levels(temp)[1]
levels(temp)
levels(temp)[1]
levels(temp)[1] <- "Fr77"
levels(temp)[2]
levels(temp)[2] <- NA
levels(temp)[2]
levels(temp)[2] <- "P1"
levels(temp)[3]
levels(temp)[4]
levels(temp)[4] <- "Fr77"
levels(temp)[5]
levels(temp)[5] <- "Fs37"
levels(temp)[6]
levels(temp)[5] <- "Fs36"
levels(temp)[7]
levels(temp)[8]
levels(temp)[9]
levels(temp)[10]
levels(temp)[11]
agitation_tests$alien_colony_ID <- temp
temp <- agitation_tests$treatment
temp
temp <- gsub(temp, "poly", "F. polyctena")
temp <- agitation_tests$treatment
temp <- gsub("poly", "F. polyctena", temp)
temp
temp <- agitation_tests$treatment
temp <- gsub(".*poly.*", "F. polyctena", temp)
temp
temp <- gsub(".*Fs.*", "F. sanguinea", temp)
temp
temp <- gsub(".*P1.*", "F. polyctena", temp)
temp <- gsub(".*Fp.*", "F. polyctena", temp)
temp <- gsub(".*Fr.*", "F. polyctena", temp)
temp
agitation_tests$treatment <- temp
usethis::use_data(agitation_tests)
usethis::use_data(agitation_tests, overwrite = TRUE)
head(agitstion_tests)
head(agitation_tests)
unique(agiatation_tests$territory)
unique(agitatation_tests$territory)
unique(agitation_tests$territory)
agitation_tests$territory <- as.factor(agitation_tests$territory)
agitation_tests$territory[1]
agitation_tests$territory[1] <- "T"
levels(agitation_tests$territory)[1]
levels(agitation_tests$territory)[1] <- "B"
levels(agitation_tests$territory)[2] <- "T"
colnames(agitation_tests)
colnames(agitation_tests)[10]
agiatation_test<- agitation_tests[,-10]
head(agitation_tests)
agiatation_tests<- agitation_tests[,-10]
head(agitation_tests)
agitation_tests<- agitation_tests[,-10]
head(agitation_tests)
usethis::use_data(agitation_tests, overwrite = TRUE)
knitr::opts_chunk$set(echo = TRUE)
# Load dataset
# data("agitation_tests")
# summarize duration of aggressive behaviour over the experiment
agitation_tests_summary <- group_by(agitation_tests, colony, treatment) %>%
summarise(aggression_duration=sum(aggression_duration)) %>%
left_join(distinct(select(agitation_tests, colony, territory)))
# difference in aggression toward F. polyctena between colonies located within and
# outside rufa territory
x<-filter(agitation_tests_summary, species=="F. polyctena", territory=="B")$aggression_duration
devtools::check()
devtools::document()
install.packages("roxygen2")
install.packages("roxygen2")
install.packages("roxygen2")
install.packages("roxygen2")
install.packages("roxygen2")
usethis::use_vignette("Statistical tests")
usethis::use_vignette("Statistical_tests")
devtools::build_rmd("vignettes/Statistical_tests.Rmd")
temp <- as.Date("2020-12-31")
class(temp)
devtools::build_rmd("vignettes/Statistical_tests.Rmd")
devtools::document()
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
devtools::document()
devtools::build_rmd("vignettes/Statistical_tests.Rmd")
devtools::load_all()
data("aggression_probing_tests")
colnames(aggression_probing_tests)
?chisq.test
devtools::document()
model_data <-transform_to_sigle_val(data = aggression_probing_tests, column = "actual_fus_numb")
# treatment sanguinea_20 should be removed due to significantly lower fusca activity
model_data<-filter(model_data, territory %in% c("B","T"),
date > as.Date("2016-12-30"),
date < as.Date("2020-12-30"),
!is.na(temperature),
treatment!="sanguinea_20")
colnames(model_data)
aggression_records <- filter(model_data, aggression_num > 0)
new_dataset<-data.frame()
for(i in 1:nrow(model_data)){
Test = model_data$test_ID[i]
interval = model_data$time_elapsed[i]
# include experiments with no aggression
if (!(Test %in% aggression_records$test_ID)){
new_dataset <- rbind(new_dataset, model_data[i,])
next
}
# include experiment part before aggression occurred
reference_set <- filter(aggression_records, Test_ID == Test)
if (all(interval < reference_set$time))
new_dataset<-rbind(new_dataset, model_data[i,])
}
new_dataset<-data.frame()
for(i in 1:nrow(model_data)){
Test = model_data$test_ID[i]
interval = model_data$time_elapsed[i]
# include experiments with no aggression
if (!(Test %in% aggression_records$test_ID)){
new_dataset <- rbind(new_dataset, model_data[i,])
next
}
# include experiment part before aggression occurred
reference_set <- filter(aggression_records, test_ID == Test)
if (all(interval < reference_set$time))
new_dataset<-rbind(new_dataset, model_data[i,])
}
model_data <- new_dataset
model_data$temperature <- model_data$temperature - mean(model_data$temperature)
model_data$temperature<-model_data$temperature/sd(model_data$temperature)
model_data$temperature
devtools::build_rmd("vignettes/Statistical_tests.Rmd")
devtools::build_rmd("vignettes/Statistical_tests.Rmd")
devtools::build_rmd("vignettes/Statistical_tests.Rmd")
devtools::check()
devtools::build_rmd("vignettes/Statistical_tests.Rmd")
model_data$temperature
log10(model_data$temperature)
model_data$temperature <- model_data$temperature - min(model_data$temperature) + 1
# temperature transformation: normalize standard deviation
model_data$temperature <- model_data$temperature/sd(model_data$temperature)
log10(model_data$temperature)
mixed.model.temp<-glmer(actual_fus_numb ~ temperature + (1|colony) + territory +
I(log10(time)), data=model_data, family="poisson")
library(lme4)
library(lmerTest)
library(DHARMa)
mixed.model.temp<-glmer(actual_fus_numb ~ temperature + (1|colony) + territory +
I(log10(time)), data=model_data, family="poisson")
mixed.model.temp<-glmer(actual_fus_numb ~ temperature + (1|colony) + territory +
I(log10(time_elapsed)), data=model_data, family="poisson")
summary(mixed.model.temp)
sim.resid <- simulateResiduals(mixed.model.temp)
plot(sim.resid)
model_data
devtools::build_rmd("vignettes/Statistical_tests.Rmd")
model_data <-transform_to_sigle_val(data = aggression_probing_tests, column = "actual_fus_numb")
# treatment sanguinea_20 should be removed due to significantly lower fusca activity
model_data<-filter(model_data, territory %in% c("B","T"),
date > as.Date("2016-12-30"),
date < as.Date("2020-12-30"),
!is.na(temperature),
treatment!="sanguinea_20")
aggression_records <- filter(model_data, aggression_num > 0)
new_dataset<-data.frame()
for(i in 1:nrow(model_data)){
Test = model_data$test_ID[i]
interval = model_data$time_elapsed[i]
# include experiments with no aggression
if (!(Test %in% aggression_records$test_ID)){
new_dataset <- rbind(new_dataset, model_data[i,])
next
}
# include experiment part before aggression occurred
reference_set <- filter(aggression_records, test_ID == Test)
if (all(interval < reference_set$time))
new_dataset<-rbind(new_dataset, model_data[i,])
}
model_data <- new_dataset
model_data$temperature <- model_data$temperature - min(model_data$temperature) + 1
sd(model_data$temperature)
temp <- sd(model_data$temperature)
10^0.15852
?simulateResiduals
devtools::build_rmd("vignettes/Statistical_tests.Rmd")
10^0.15852
temp
exp(0.15852)
exp(0.15852/temp)
exp(0.15852/temp)^10
mixed.model.temp
fixef(mixed.model.temp)
fixef(mixed.model.temp)$temperature
fixef(mixed.model.temp)['temperature']
devtools::build_rmd("vignettes/Statistical_tests.Rmd")
