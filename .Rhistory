temp_data_4<-read.table('protokoly_2020.csv', sep=',', header=TRUE)
library(stringi)
daty<-character(nrow(temp_data_4))
daty2<-numeric(nrow(temp_data_4))
for (i in 1:nrow(temp_data_4)){
daty[i]<-stri_paste(stri_extract_all_regex(temp_data_4$date[i], '[0-9]+')[[1]][1],
stri_extract_all_regex(temp_data_4$date[i], '[0-9]+')[[1]][2], '2020', sep='.')
#print(strptime(daty[i], '%d.%m.%Y'))
daty2[i]<-as.Date(strptime(daty[i], '%d.%m.%Y'))
}
daty2<-as.Date(daty2, origin='1970-01-01')
temp_data_4$date<-daty2
temp_data_4<-limits_separation(temp_data_4)
temp_data_4<-limits_separation_2(temp_data_4)
temp_data<-split(temp_data_4, temp_data_4$colony)
temp_data<-lapply(temp_data, function(x){
data.frame(colony=x$colony[1],aggression=any(x$aggression_num!=0), territory=x$territory[1], num_upper=(max(na.omit(x$aggression_num_upper))),num_lower=(min(na.omit(x$aggression_num_lower))))
})
temp_data<-do.call(rbind,temp_data)
temp_data_2<-split(new_data, new_data$colony)
temp_data_2<-lapply(temp_data_2, function(x){
data.frame(colony=x$colony[1],headwidth=mean(x$head_width),n=nrow(x))
})
temp_data_2<-do.call(rbind,temp_data_2)
new_data_2<-merge(temp_data, temp_data_2, by='colony', all.x=TRUE)
results_2020<-new_data_2
temp_data_3<-split(temp_data_4, temp_data_4$colony)
temp_data_3<-lapply(temp_data_3, function(x){
x<-x[order(x$date),]
y<-x[1,c('colony','treatment')]
y
})
temp_data_3<-do.call(rbind,temp_data_3)
colnames(temp_data_3)[2]<-'first_treatment'
library(dplyr)
temp_data<-group_by(temp_data_4, colony, treatment)
temp_data<-summarize(temp_data, aggression=any(aggression_num!=0))
temp_data<-ungroup(temp_data)
temp_data<-as.data.frame(temp_data)
temp_data<-split(temp_data,temp_data$treatment)
colnames(temp_data[[1]])[3]<-'treatment 1'
colnames(temp_data[[2]])[3]<-'treatment 20'
results_2020<-merge(results_2020, temp_data[[1]][,c(1,3)], by='colony', all.x=TRUE)
results_2020<-merge(results_2020, temp_data[[2]][,c(1,3)], by='colony',all.x=TRUE)
results_2020<-results_2020[,-2]
results_2020<-merge(results_2020, temp_data_3, by='colony', all.x=TRUE)
results_2020<-results_2020[order(results_2020$territory),]
summarised_results<-rbind(results_2019,results_2020)
temp_data_4<-read.table('D:\\Badania\\Agresywność mrówek F. fusca na i poza terytorium F. polyctena\\Analiza danychprotokoly_2020.csv', sep=',', header=TRUE)
temp_data_4<-read.table('D:\\Badania\\Agresywność mrówek F. fusca na i poza terytorium F. polyctena\\Analiza danych\\protokoly_2020.csv', sep=',', header=TRUE)
library(stringi)
daty<-character(nrow(temp_data_4))
daty2<-numeric(nrow(temp_data_4))
for (i in 1:nrow(temp_data_4)){
daty[i]<-stri_paste(stri_extract_all_regex(temp_data_4$date[i], '[0-9]+')[[1]][1],
stri_extract_all_regex(temp_data_4$date[i], '[0-9]+')[[1]][2], '2020', sep='.')
#print(strptime(daty[i], '%d.%m.%Y'))
daty2[i]<-as.Date(strptime(daty[i], '%d.%m.%Y'))
}
daty2<-as.Date(daty2, origin='1970-01-01')
temp_data_4$date<-daty2
temp_data_4<-limits_separation(temp_data_4)
temp_data_4<-limits_separation_2(temp_data_4)
temp_data<-split(temp_data_4, temp_data_4$colony)
temp_data<-lapply(temp_data, function(x){
data.frame(colony=x$colony[1],aggression=any(x$aggression_num!=0), territory=x$territory[1], num_upper=(max(na.omit(x$aggression_num_upper))),num_lower=(min(na.omit(x$aggression_num_lower))))
})
temp_data<-do.call(rbind,temp_data)
temp_data_2<-split(new_data, new_data$colony)
temp_data_2<-lapply(temp_data_2, function(x){
data.frame(colony=x$colony[1],headwidth=mean(x$head_width),n=nrow(x))
})
temp_data_2<-do.call(rbind,temp_data_2)
new_data_2<-merge(temp_data, temp_data_2, by='colony', all.x=TRUE)
results_2020<-new_data_2
temp_data_3<-split(temp_data_4, temp_data_4$colony)
temp_data_3<-lapply(temp_data_3, function(x){
x<-x[order(x$date),]
y<-x[1,c('colony','treatment')]
y
})
temp_data_3<-do.call(rbind,temp_data_3)
colnames(temp_data_3)[2]<-'first_treatment'
library(dplyr)
temp_data<-group_by(temp_data_4, colony, treatment)
temp_data<-summarize(temp_data, aggression=any(aggression_num!=0))
temp_data<-ungroup(temp_data)
temp_data<-as.data.frame(temp_data)
temp_data<-split(temp_data,temp_data$treatment)
colnames(temp_data[[1]])[3]<-'treatment 1'
colnames(temp_data[[2]])[3]<-'treatment 20'
results_2020<-merge(results_2020, temp_data[[1]][,c(1,3)], by='colony', all.x=TRUE)
results_2020<-merge(results_2020, temp_data[[2]][,c(1,3)], by='colony',all.x=TRUE)
results_2020<-results_2020[,-2]
results_2020<-merge(results_2020, temp_data_3, by='colony', all.x=TRUE)
results_2020<-results_2020[order(results_2020$territory),]
summarised_results<-rbind(results_2019,results_2020)
